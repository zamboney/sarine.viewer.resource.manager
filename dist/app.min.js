(function(){var a;a=function(){function a(){console.log("new singleton"),f=new c,d=new b}var b,c,d,e,f;return e=void 0,f=void 0,d=void 0,a.getInstance=function(){return void 0===e&&(e=new this),e},b=function(){function a(){}return a.prototype.imageObj={},a.prototype.loadImage=function(a,b){var c,d,e;return e=this,void 0===this.imageObj[b.id]&&(this.imageObj[b.id]={capacity:b.downloadLimit||2,bag:[],threshhold:[]}),c=$.Deferred(),d=new Image,d.crossOrigin="Anonymous",d.onload=function(a){var c,d,f;return c=$.inArray(e.imageObj[b.id].threshhold.filter(function(){return function(b){return b.src===a.target.src}}(this))[0],e.imageObj[b.id].threshhold),d=e.imageObj[b.id].threshhold[c],f=e.imageObj[b.id].bag.shift(),f&&(f.img.src=f.src,e.imageObj[b.id].threshhold.push(f)),e.imageObj[b.id].threshhold.splice(c,1),d.defer.resolve(a.target)},this.imageObj[b.id].threshhold.length<this.imageObj[b.id].capacity?(this.imageObj[b.id].threshhold.push({defer:c,src:a,img:d}),d.src=a):this.imageObj[b.id].bag.push({defer:c,src:a,img:d}),c},a}(),a.prototype.loadImage=function(a){return d.loadImage(a,this)},c=function(){function a(){}var b;return b={},a.add=function(a,c,d){var e;return e={defer:c,item:d},b[a]||(setTimeout(function(a){var c,d;return c=b[a],b[a]=void 0,d=$.unique(c.map(function(a){return a.item.id})),c.forEach(function(a){return a.defer.resolve.apply(a.item)})},a,a),b[a]=[]),0===b[a].filter(function(a){return a.item.id===e.item.id}).length?b[a].push(e):void 0},a}(),a.prototype.setTimeout=function(a){var b;return b=$.Deferred(),c.add(a,b,this),b},a}(),this.ResourceManager=a}).call(this);